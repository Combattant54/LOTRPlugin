package fr.combattant54.lotrplugin.timers;

import fr.combattant54.lotrapi.annotations.Timer;
import fr.combattant54.lotrapi.basekeys.Prefix;
import fr.combattant54.lotrapi.basekeys.TimerBase;
import fr.combattant54.lotrapi.enums.Sound;
import fr.combattant54.lotrapi.events.game.timers.InvulnerabilityEvent;
import fr.combattant54.lotrapi.game.WereWolfAPI;
import fr.combattant54.lotrapi.listeners.impl.ListenerWerewolf;
import org.bukkit.Bukkit;
import org.bukkit.event.EventHandler;

@Timer(key = TimerBase.INVULNERABILITY,
        defaultValue = 30,
        meetUpValue = 30,
        decrement = true,
        onZero = InvulnerabilityEvent.class)
public class Invulnerability extends ListenerWerewolf {

    public Invulnerability(WereWolfAPI main) {
        super(main);
    }

    @EventHandler
    public void onInvulnerabilityEnd(InvulnerabilityEvent event) {
        Bukkit.getOnlinePlayers()
                .forEach(player -> {
                    player.sendMessage(this.getGame()
                            .translate(Prefix.ORANGE, "werewolf.announcement.invulnerability"));
                    Sound.GLASS.play(player);
                });
    }
}
